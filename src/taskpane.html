<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงููุฑุงุฌุน ุงููุบูู</title>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <!-- Styles -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="taskpane.css">
</head>

<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>ุงููุฑุงุฌุน ุงูุฐูู</h1>
                <div class="header-actions">
                    <button id="history-btn" class="icon-btn" title="ุณุฌู ุงูุนูููุงุช">๐</button>
                    <button id="settings-btn" class="icon-btn settings-toggle" title="ุงูุฅุนุฏุงุฏุงุช">โ๏ธ</button>
                </div>
            </div>
        </header>

        <!-- History Modal -->
        <div id="history-modal" class="settings-modal hidden">
            <div class="settings-content">
                <div class="settings-header">
                    <h2>ุณุฌู ุงูุนูููุงุช</h2>
                    <button id="close-history" class="close-btn">โ</button>
                </div>
                <div id="history-list" class="history-list">
                    <p class="empty-msg">ูุง ุชูุฌุฏ ุนูููุงุช ุณุงุจูุฉ.</p>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settings-modal" class="settings-modal hidden">
            <div class="settings-content">
                <div class="settings-header">
                    <h2>ุงูุฅุนุฏุงุฏุงุช</h2>
                    <button id="close-settings" class="close-btn">โ</button>
                </div>
                <div class="input-group">
                    <label for="api-key">ููุชุงุญ API:</label>
                    <input type="password" id="api-key" value="" placeholder="ุฃุฏุฎู ููุชุงุญ Gemini API ููุง..." />
                </div>
                <div class="input-group">
                    <label for="model-select">ุงููููุฐุฌ:</label>
                    <input type="text" id="model-select" value="gemini-2.5-flash"
                        placeholder="ูุซุงู: gemini-2.5-flash" />
                    <button id="fetch-models" class="secondary-btn">๐ ุฌูุจ ุงูููุงุฐุฌ</button>
                    <div id="models-list" class="models-list"></div>
                </div>
                <div class="input-group highlight-settings">
                    <label class="checkbox-container">
                        <input type="checkbox" id="highlight-corrections" />
                        <span class="checkbox-label">ุชูููุฒ ุงูุชุนุฏููุงุช ุจููู</span>
                    </label>
                    <div class="color-picker-container">
                        <input type="color" id="highlight-color" value="#ffff00" />
                        <span class="color-value-label">ุงุฎุชุฑ ุงูููู</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quran Search Modal - Fullscreen Browser Style -->
        <div id="quran-modal" class="settings-modal hidden">
            <div class="settings-content quran-search-modal">
                <div class="settings-header">
                    <h2>ุงูุจุญุซ ูู ุงููุฑุขู ุงููุฑูู</h2>
                    <button id="close-quran" class="close-btn">โ</button>
                </div>
                <div class="quran-iframe-container">
                    <iframe id="quran-iframe" src="https://tafsir.app/" frameborder="0"
                        allow="clipboard-read; clipboard-write" style="width: 100%; height: 100%; border: none;">
                    </iframe>
                </div>
            </div>
        </div>

        <!-- Alminasa Modal -->
        <div id="alminasa-modal" class="settings-modal hidden">
            <div class="settings-content quran-search-modal">
                <div class="settings-header">
                    <h2>ุงูููุตุฉ ุงูุญุฏูุซุฉ</h2>
                    <button id="close-alminasa" class="close-btn">โ</button>
                </div>
                <div class="quran-iframe-container">
                    <iframe id="alminasa-iframe" src="https://alminasa.ai/" frameborder="0"
                        allow="clipboard-read; clipboard-write; microphone; camera"
                        style="width: 100%; height: 100%; border: none;">
                    </iframe>
                </div>
            </div>
        </div>

        <!-- Turath Modal -->
        <div id="turath-modal" class="settings-modal hidden">
            <div class="settings-content quran-search-modal">
                <div class="settings-header">
                    <h2>ุฌุงูุน ุงููุชุจ ุงูุฅุณูุงููุฉ</h2>
                    <button id="close-turath" class="close-btn">โ</button>
                </div>
                <div class="quran-iframe-container">
                    <iframe id="turath-iframe" src="https://ketabonline.com/ar" frameborder="0"
                        allow="clipboard-read; clipboard-write; microphone; camera"
                        style="width: 100%; height: 100%; border: none;">
                    </iframe>
                </div>
            </div>
        </div>

        <!-- Internal Browser Modal -->
        <div id="google-modal" class="settings-modal hidden">
            <div class="settings-content quran-search-modal">
                <div class="browser-toolbar">
                    <div class="browser-controls">
                        <button id="browser-back" title="ููุฎูู">โ</button>
                        <button id="browser-forward" title="ููุฃูุงู">โถ</button>
                        <button id="browser-refresh" title="ุชุญุฏูุซ">๐</button>
                    </div>
                    <div class="browser-address-bar">
                        <input type="text" id="browser-url" placeholder="ุงุจุญุซ ุฃู ุฃุฏุฎู ุฑุงุจุทุงู..." dir="ltr" />
                        <button id="browser-go">ุจุญุซ</button>
                    </div>
                    <button id="close-google" class="browser-close" title="ุฅุบูุงู">โ</button>
                </div>
                <div class="quran-iframe-container">
                    <iframe id="google-iframe" src="about:blank" frameborder="0"
                        allow="clipboard-read; clipboard-write; microphone; camera; fullscreen"
                        style="width: 100%; height: 100%; border: none;">
                    </iframe>
                </div>
            </div>
        </div>

        <!-- Linguistic Analysis Modal -->
        <div id="analysis-modal" class="settings-modal hidden">
            <div class="settings-content quran-search-modal">
                <div class="settings-header" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                    <h2>ุงูุชุญููู ุงููุบูู ูุงููุนุฌู</h2>
                    <button id="close-analysis" class="close-btn">โ</button>
                </div>
                <div class="analysis-container" style="flex: 1; overflow-y: auto; padding: 20px; background: #f0fdf4;">
                    <div id="analysis-loading" class="hidden" style="text-align: center; padding: 40px;">
                        <div class="spinner"
                            style="border: 4px solid rgba(16, 185, 129, 0.1); border-top: 4px solid #10b981; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 20px;">
                        </div>
                        <p style="color: #059669; font-weight: 600;">ุฌุงุฑู ุชุญููู ุงููููุฉ ูุบููุงู...</p>
                    </div>
                    <div id="analysis-results" class="analysis-view">
                        <!-- Results will be injected here -->
                    </div>
                </div>
            </div>
        </div>

        <main>
            <div class="main-sections">
                <section class="action-card primary-card">
                    <div class="section-header">
                        <span class="section-icon">โจ</span>
                        <h2>ุงููุฑุงุฌุนุฉ ูุงูุชุญููู ุงูุฐูู</h2>
                    </div>
                    <button id="run-check" class="primary-button">
                        <span class="icon">๐</span> ุชุดุบูู ุงููุฑุงุฌุนุฉ ุงูุดุงููุฉ
                    </button>
                    <button id="btn-linguistic-analysis" class="primary-button"
                        style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);">
                        <span class="icon">๐ง</span> ุงูุชุญููู ุงููุบูู ูุงููุนุฌู
                    </button>
                    <button id="btn-fast-fix" class="tool-btn fast-fix-btn"
                        title="ุฅุตูุงุญ ููุฑู ูุชููุงุฆู ูููุณุงูุงุช ูุงูุชุฑููู">
                        <span class="icon">โก</span> ุงูุฅุตูุงุญ ุงูุชููุงุฆู ุงูุณุฑูุน
                    </button>
                </section>

                <!-- Section 2: Text Formatting & Brackets -->
                <section class="action-card">
                    <div class="section-header">
                        <span class="section-icon">โ๏ธ</span>
                        <h2>ุชูุณูู ุงููุตูุต</h2>
                    </div>

                    <!-- Brackets Wrap -->
                    <div class="sub-tool-group">
                        <div class="bracket-palette">
                            <button class="bracket-item" onclick="handleWrapText('(', ')')">( )</button>
                            <button class="bracket-item" onclick="handleWrapText('[', ']')">[ ]</button>
                            <button class="bracket-item" onclick="handleWrapText('-', '-')">- -</button>
                            <button class="bracket-item" onclick="handleWrapText('๏ดฟ', '๏ดพ')">๏ดฟ ๏ดพ</button>
                            <button class="bracket-item" onclick="handleWrapText('ยซ', 'ยป')">ยซ ยป</button>
                            <button class="bracket-item" onclick="handleWrapText('&quot;', '&quot;')">" "</button>
                        </div>
                    </div>

                    <div class="compact-grid">
                        <button id="btn-tashkeel" class="tool-btn-small" title="ุฅุถุงูุฉ ุงูุชุดููู">
                            <span class="icon">โจ</span> ุชุดููู
                        </button>
                        <button id="btn-remove-tashkeel" class="tool-btn-small" title="ุฅุฒุงูุฉ ุงูุชุดููู">
                            <span class="icon">ู</span> ุญุฐู ุชุดููู
                        </button>
                        <button id="btn-reverse-brackets" class="tool-btn-small" title="ุชุตุญูุญ ุงูุฃููุงุณ">
                            <span class="icon">()</span> ุถุจุท ุงูุฃููุงุณ
                        </button>
                        <button id="btn-remove-brackets" class="tool-btn-small danger-btn" title="ุญุฐู ุฌููุน ุงูุฃููุงุณ">
                            <span class="icon">โ๏ธ</span> ูุณุญ ุงูุฃููุงุณ
                        </button>
                        <button id="btn-remove-empty-lines" class="tool-btn-small wide-btn" title="ุญุฐู ุงูุฃุณุทุฑ ุงููุงุฑุบุฉ">
                            <span class="icon">โฐ</span> ุญุฐู ุงูุฃุณุทุฑ ุงููุงุฑุบุฉ
                        </button>
                    </div>
                </section>



                <!-- Section 3: Research & External Resources -->
                <section class="action-card">
                    <div class="section-header">
                        <span class="section-icon">๐</span>
                        <h2>ุงููุตุงุฏุฑ ูุงููุฑุงุฌุน</h2>
                    </div>
                    <div class="resources-grid">
                        <button id="btn-quran-search" class="resource-btn quran" title="ุงููุฑุขู ุงููุฑูู">
                            <span class="icon">๐</span> ุงููุฑุขู
                        </button>
                        <button id="btn-alminasa" class="resource-btn alminasa" title="ุงูููุตุฉ ุงูุญุฏูุซุฉ">
                            <span class="icon">๐ค</span> ุงูููุตุฉ
                        </button>
                        <button id="btn-turath" class="resource-btn turath" title="ุฌุงูุน ุงููุชุจ ุงูุฅุณูุงููุฉ">
                            <span class="icon">๐</span> ุฌุงูุน ุงููุชุจ
                        </button>
                        <button id="btn-google-search" class="resource-btn google" title="ุจุญุซ ุฌูุฌู">
                            <span class="icon">๐</span> ุฌูุฌู
                        </button>
                    </div>
                </section>
            </div>





            <div id="message-area" class="message-area"></div>

            <!-- Results Fullscreen Modal -->
            <div id="results-modal" class="settings-modal hidden">
                <div class="settings-content quran-search-modal">
                    <div class="settings-header" style="background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);">
                        <h2>ูุชุงุฆุฌ ุงููุฑุงุฌุนุฉ ุงูุดุงููุฉ</h2>
                        <div style="display: flex; gap: 10px;">
                            <button id="export-pdf-modal" class="close-btn" title="ุชุตุฏูุฑ PDF"
                                style="font-size: 1.2rem; background: rgba(255,255,255,0.2);">๐</button>
                            <button id="close-results" class="close-btn">โ</button>
                        </div>
                    </div>
                    <div class="quran-iframe-container" style="padding: 15px; overflow-y: auto; background: #f8fafc;">
                        <div id="progress-area" class="hidden" style="margin-bottom: 20px;">
                            <div class="progress-bar">
                                <div id="progress-fill" style="width: 0%"></div>
                            </div>
                            <p id="progress-text">ุฌุงุฑู ุงููุนุงูุฌุฉ...</p>
                        </div>

                        <div id="results-area" class="results-area">
                            <!-- Extra Spaces -->
                            <div id="section-spaces" class="category-section hidden">
                                <div class="category-header" onclick="toggleSection('spaces')">
                                    <div class="header-title">
                                        <h3>โ๏ธ ูุณุงูุงุช ุฒุงุฆุฏุฉ</h3>
                                        <span id="count-spaces" class="count-badge">0</span>
                                    </div>
                                    <span class="toggle-icon">โผ</span>
                                </div>
                                <div id="content-spaces" class="section-content hidden">
                                    <div class="batch-actions">
                                        <button class="batch-btn" onclick="applyBatch('spaces')">ุฅุตูุงุญ ุงููู</button>
                                    </div>
                                    <ul id="list-spaces"></ul>
                                </div>
                            </div>

                            <!-- Spelling -->
                            <div id="section-spelling" class="category-section hidden">
                                <div class="category-header" onclick="toggleSection('spelling')">
                                    <div class="header-title">
                                        <h3>๐ ุฃุฎุทุงุก ุฅููุงุฆูุฉ</h3>
                                        <span id="count-spelling" class="count-badge">0</span>
                                    </div>
                                    <span class="toggle-icon">โผ</span>
                                </div>
                                <div id="content-spelling" class="section-content hidden">
                                    <div class="batch-actions">
                                        <button class="batch-btn" onclick="applyBatch('spelling')">ุชุทุจูู ุงููู</button>
                                    </div>
                                    <ul id="list-spelling"></ul>
                                </div>
                            </div>

                            <!-- Grammar -->
                            <div id="section-grammar" class="category-section hidden">
                                <div class="category-header" onclick="toggleSection('grammar')">
                                    <div class="header-title">
                                        <h3>๐ ุฃุฎุทุงุก ูุญููุฉ</h3>
                                        <span id="count-grammar" class="count-badge">0</span>
                                    </div>
                                    <span class="toggle-icon">โผ</span>
                                </div>
                                <div id="content-grammar" class="section-content hidden">
                                    <div class="batch-actions">
                                        <button class="batch-btn" onclick="applyBatch('grammar')">ุชุทุจูู ุงููู</button>
                                    </div>
                                    <ul id="list-grammar"></ul>
                                </div>
                            </div>

                            <!-- Punctuation -->
                            <div id="section-punctuation" class="category-section hidden">
                                <div class="category-header" onclick="toggleSection('punctuation')">
                                    <div class="header-title">
                                        <h3>ุ ุนูุงูุงุช ุงูุชุฑููู</h3>
                                        <span id="count-punctuation" class="count-badge">0</span>
                                    </div>
                                    <span class="toggle-icon">โผ</span>
                                </div>
                                <div id="content-punctuation" class="section-content hidden">
                                    <div class="batch-actions">
                                        <button class="batch-btn" onclick="applyBatch('punctuation')">ุชุทุจูู
                                            ุงููู</button>
                                    </div>
                                    <ul id="list-punctuation"></ul>
                                </div>
                            </div>

                            <!-- Style -->
                            <div id="section-style" class="category-section hidden">
                                <div class="category-header" onclick="toggleSection('style')">
                                    <div class="header-title">
                                        <h3>๐จ ุชุญุณููุงุช ุฃุณููุจูุฉ</h3>
                                        <span id="count-style" class="count-badge">0</span>
                                    </div>
                                    <span class="toggle-icon">โผ</span>
                                </div>
                                <div id="content-style" class="section-content hidden">
                                    <div class="batch-actions">
                                        <button class="batch-btn" onclick="applyBatch('style')">ุชุทุจูู ุงููู</button>
                                    </div>
                                    <ul id="list-style"></ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <!-- Main Scripts -->
    <script src="config.js"></script>
    <script src="taskpane.js"></script>
</body>

</html>